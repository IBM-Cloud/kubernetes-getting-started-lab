
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Monitoring Â· Getting started with scalable web application on Kubernetes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-prism/prism-tomorrow.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fancybox/jquery.fancybox.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fancybox/jquery.fancybox-buttons.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-web-header/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-codetabs/codetabs.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="scaling.html" />
    
    
    <link rel="prev" href="observability-logging.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Introduction</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                        <b>1.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="prerequisites.html">
            
                <a href="prerequisites.html">
            
                    
                        <b>1.2.</b>
                    
                    Prerequisites
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">IBM Cloud Kubernetes Service</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="iks-tour.html">
            
                <a href="iks-tour.html">
            
                    
                        <b>2.1.</b>
                    
                    IBM Cloud Kubernetes Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="iks-tour-overview.html">
            
                <a href="iks-tour-overview.html">
            
                    
                        <b>2.2.</b>
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="iks-tour-workers.html">
            
                <a href="iks-tour-workers.html">
            
                    
                        <b>2.3.</b>
                    
                    Worker Nodes and Pools
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Prepare</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="prepare.html">
            
                <a href="prepare.html">
            
                    
                        <b>3.1.</b>
                    
                    Log in IBM Cloud
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="prepare-target.html">
            
                <a href="prepare-target.html">
            
                    
                        <b>3.2.</b>
                    
                    Target your environment
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Create</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="create-app.html">
            
                <a href="create-app.html">
            
                    
                        <b>4.1.</b>
                    
                    Create
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="create-app-build.html">
            
                <a href="create-app-build.html">
            
                    
                        <b>4.2.</b>
                    
                    Build locally
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="create-app-run.html">
            
                <a href="create-app-run.html">
            
                    
                        <b>4.3.</b>
                    
                    Run locally
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Deploy</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="push-app.html">
            
                <a href="push-app.html">
            
                    
                        <b>5.1.</b>
                    
                    Push to registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="deploy-app.html">
            
                <a href="deploy-app.html">
            
                    
                        <b>5.2.</b>
                    
                    Deploy with Helm
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Access</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="ingress-with-ibm-domain.html">
            
                <a href="ingress-with-ibm-domain.html">
            
                    
                        <b>6.1.</b>
                    
                    Use IBM ingress domain
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="ingress-with-custom-domain.html">
            
                <a href="ingress-with-custom-domain.html">
            
                    
                        <b>6.2.</b>
                    
                    Use a custom domain
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Observe</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="observability.html">
            
                <a href="observability.html">
            
                    
                        <b>7.1.</b>
                    
                    Kubernetes Dashboard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="observability-logging.html">
            
                <a href="observability-logging.html">
            
                    
                        <b>7.2.</b>
                    
                    Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="7.3" data-path="observability-monitoring.html">
            
                <a href="observability-monitoring.html">
            
                    
                        <b>7.3.</b>
                    
                    Monitoring
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Scale</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="scaling.html">
            
                <a href="scaling.html">
            
                    
                        <b>8.1.</b>
                    
                    Scaling
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Conclusion</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="cleanup.html">
            
                <a href="cleanup.html">
            
                    
                        <b>9.1.</b>
                    
                    Remove resources
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="conclusion.html">
            
                <a href="conclusion.html">
            
                    
                        <b>9.2.</b>
                    
                    Conclusion
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Monitoring</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="monitoring">Monitoring</h1>
<!-- ## Using Grafana

Metrics for standard clusters are located in the IBM Cloud account that was logged in to when the Kubernetes cluster was created. If you specified an IBM Cloud space when you created the cluster, then metrics are located in that space. Container metrics are collected automatically for all containers that are deployed in a cluster. These metrics are sent and are made available through Grafana.

1. To view **metrics**, navigate to [clusters](https://cloud.ibm.com/containers-kubernetes/clusters) and select the appropriate **location** to see your cluster.
2. Next to **Metrics**, click **View**. This should launch Grafana in a new tab.
3. In the top right corner, click on your username and choose **Domain**: **account** and select your **Account**.
4. Click on **Home** and select the **ClusterMonitoringDashboard_V5** dashboard that has been pre-defined.
5. Select the region value where your cluster was created next to **Region** and select your cluster name next to **Cluster**.
   ![](images/grafana_region_cluster.png)
6. In a different window, visit your application URL and refresh the page several times to generate some load.
7. Refresh your Grafana dashboard to see the updated metrics.
   ![](images/grafana.png) -->
<h2 id="using-ibm-cloud-monitoring-with-sysdig">Using IBM Cloud Monitoring with Sysdig</h2>
<p>Sysdig monitor is a third-party cloud-native container-intelligence management system. You can use this to gain operational visibility for your applications, services, and platform. Sysdig offers administrators, DevOps teams and developers advanced features to monitor and troubleshoot, define alerts, and design custom views.</p>
<p>     <a href="images/observability-monitoring-sysdig-catalog.png" rel="grouped" title="Sysdig in catalog" target="_self" class="fancybox">
       <img src="images/observability-monitoring-sysdig-catalog.png" alt="Sysdig in catalog">
     </a></p>
<h2 id="configure-your-cluster-with-sysdig">Configure your cluster with Sysdig</h2>
<ol>
<li>Switch to your personal IBM Cloud account.</li>
<li>Create an instance of <a href="https://cloud.ibm.com/observe/monitoring/create" target="_blank">IBM Cloud Monitoring with Sysdig</a> from the catalog:<ol>
<li>Set the <strong>Service name</strong> to <strong>YOUR_IBM_ID-sysdig</strong>.</li>
<li>Select the location where your cluster is created. If the location is not in the list, pick Dallas (us-south).</li>
<li>Use the default resource group.</li>
<li>Click <strong>Create</strong>.</li>
</ol>
</li>
<li>In the <a href="https://cloud.ibm.com/observe/monitoring" target="_blank"><strong>Observability</strong> category, under Monitoring</a>, locate the service instance you created.</li>
<li>Click <strong>View access keys</strong> and copy your access key as it will be needed in later steps.</li>
</ol>
<!-- 1. Select **Kubernetes** as a source and at the bootom of that page follow the instructions to Install Sysdig Agent to your cluster or follow the steps below:

1. ***TO DELETE:*** Automated steps included in the instructions are bash only and they do not work in Windows Command line. 
```sh
curl -sL https://ibm.biz/install-sysdig-k8s-agent | bash -s -- -a b66e3139-b40a-46bc-af17-615dceedfdd0 -c ingest.us-south.monitoring.cloud.ibm.com -ac 'sysdig_capture_enabled: false'
``` -->
<p><em>Note: The instructions that follow are based on the published instructions found here:</em> <a href="https://cloud.ibm.com/docs/services/Monitoring-with-Sysdig/config_agent.html#kube_manually" target="_blank">Install Sysdig Agent manually to your cluster</a></p>
<ol>
<li><p>Create a service account called sysdig-agent to monitor the kubernetes cluster. Run the following command:</p>
<pre class="language-"><code class="lang-sh"> kubectl create serviceaccount sysdig-agent
</code></pre>
</li>
<li><p>Add a secret to your Kubernetes cluster. Run the following command:</p>
<pre class="language-"><code class="lang-sh"> kubectl create secret generic sysdig-agent --from-literal<span class="token operator">=</span>access-key<span class="token operator">=</span>SYSDIG_ACCESS_KEY
</code></pre>
<p> The SYSDIG_ACCESS_KEY is the access key copied earlier.</p>
<p> The Kubernetes secret contains the ingestion key which is used to authenticate the Sysdig agent with the IBM Cloud Monitoring with Sysdig service. It is used to open a secure web socket to the ingestion server on the monitoring back-end system.</p>
</li>
<li><p>Create a cluster role and cluster role binding.</p>
<p> Download the <a href="https://raw.githubusercontent.com/draios/sysdig-cloud-scripts/master/agent_deploy/kubernetes/sysdig-agent-clusterrole.yaml" target="_blank">sysdig-agent-clusterrole.yaml</a>.</p>
<p> To add a cluster role, run the following command:</p>
<pre class="language-"><code class="lang-sh"> kubectl apply -f sysdig-agent-clusterrole.yaml
</code></pre>
<p> To add a cluster role binding, run the following command:</p>
<pre class="language-"><code class="lang-sh"> kubectl create clusterrolebinding sysdig-agent --clusterrole<span class="token operator">=</span>sysdig-agent --serviceaccount<span class="token operator">=</span>default:sysdig-agent
</code></pre>
</li>
<li><p>Download the <a href="https://raw.githubusercontent.com/draios/sysdig-cloud-scripts/master/agent_deploy/kubernetes/sysdig-agent-configmap.yaml" target="_blank">sysdig-agent-configmap.yaml</a>.
 Edit the sysdig-agent-configmap.yaml and add required parameters for configuring the agent to work in the IBM Cloud.</p>
<p> Use an editor to open the sysdig-agent-configmap.yaml file. Then, add the following parameters:</p>
<ul>
<li><p><strong><em>k8s_cluster_name</em></strong>: This parameter specifies the cluster name as a metric label. You can use the label kubernetes.cluster.name to navigate the Kubernetes dashboards by cluster name and filter out metrics associated with the cluster.</p>
</li>
<li><p><strong><em>collector</em></strong>: This parameter specifies the ingestion URL for the region where the monitoring instance is available.</p>
</li>
<li><p><strong><em>collector_port</em></strong>: This parameter indicates the port on which the collector is listening on. It&apos;s value must be 6443.</p>
</li>
<li><p><strong><em>ssl</em></strong>: This parameter must be set to true.</p>
</li>
<li><p><strong><em>ssl_verfiy_certificate</em></strong>: This parameter must be set to true.</p>
</li>
<li><p><strong><em>new_k8s</em></strong>: This parameter must be set to true to capture kube state metrics.</p>
</li>
<li><p><strong><em>sysdig_capture_enabled</em></strong>: This parameter enables or disables the Sysdig capture feature. By default is set to true. </p>
<p>An example yaml file looks like this:</p>
<pre class="language-"><code class="lang-sh">apiVersion: v1
kind: ConfigMap
metadata:
name: sysdig-agent
data:
dragent.yaml: <span class="token operator">|</span>
  <span class="token comment">### Agent tags</span>
  tags: linux:ubuntu,dept:dev,local:nyc

  <span class="token comment">#### Sysdig Software related config ####</span>

  <span class="token comment"># Sysdig collector address</span>
  collector: us-south.monitoring.cloud.ibm.com

  <span class="token comment"># Collector TCP port</span>
  collector_port: 6443

  <span class="token comment"># Whether collector accepts ssl</span>
  ssl: <span class="token boolean">true</span>

  <span class="token comment"># collector certificate validation</span>
  ssl_verify_certificate: <span class="token boolean">true</span>

  <span class="token comment">#######################################</span>
  new_k8s: <span class="token boolean">true</span>
  k8s_cluster_name: lab-1

  sysdig_capture_enabled: <span class="token boolean">false</span>
</code></pre>
</li>
</ul>
</li>
<li><p>Apply the config map to the cluster. Run the following command:</p>
<pre class="language-"><code class="lang-sh"> kubectl apply -f sysdig-agent-configmap.yaml
</code></pre>
</li>
<li><p>Download the <a href="https://raw.githubusercontent.com/draios/sysdig-cloud-scripts/master/agent_deploy/kubernetes/sysdig-agent-daemonset-v2.yaml" target="_blank">sysdig-agent-daemonset-v2.yaml</a>.  Apply the daemonset to deploy the Sysdig agent to the cluster. Run the following command:</p>
<pre class="language-"><code class="lang-sh"> kubectl apply -f sysdig-agent-daemonset-v2.yaml
</code></pre>
</li>
</ol>
<h2 id="view-metrics-with-sysdig">View metrics with Sysdig</h2>
<ol>
<li>Click <strong>View Sysdig</strong> to open the Sysdig console</li>
<li>In the Sysdig <em>Welcome</em> wizard<ol>
<li>Select <strong>Kubernetes</strong> as the installation method.</li>
<li>It should show one or more agents already connected.</li>
<li>Select <strong>GO TO NEXT STEP</strong>.</li>
<li>And finally <strong>LET&apos;S GET STARTED</strong></li>
</ol>
</li>
<li><p>Navigate the Sysdig console to get metrics on your Kubernetes cluster, nodes, deployments, pods, containers.</p>
<ol>
<li>Under <strong>Explore</strong>, select <strong>Containerized Apps</strong> to view raw metrics for all workloads running on the cluster.</li>
<li>Under <strong>Dashboard</strong>, select <strong>My Shared Dashboards / HTTP Overview</strong> to get a global view of the cluster HTTP load.</li>
<li>Under <strong>Dashboard</strong>, select <strong>My Shared Dashboards / Overview by Host</strong> to understand how nodes are currently performing.</li>
</ol>
<p><div class="alert alert-info hints-alert"><div class="hints-icon"><i class="fa fa-info-circle"></i></div><div class="hints-container"><p>   If Kubernetes-specific views do not show data, wait till your cluster starts sending metrics to Sysdig and refresh the Sysdig monitor console.</p>
</div></div></p>
</li>
</ol>
<p>     <a href="images/observability-monitoring-sysdig.png" rel="grouped" title="Sysdig dashboard" target="_self" class="fancybox">
       <img src="images/observability-monitoring-sysdig.png" alt="Sysdig dashboard">
     </a></p>
<p><div class="alert alert-success hints-alert"><div class="hints-icon"><i class="fa fa-mortar-board"></i></div><div class="hints-container"><p>Find more about IBM Cloud Monitoring with Sysdig in the <a href="https://cloud.ibm.com/docs/services/Monitoring-with-Sysdig/index.html#getting-started" target="_blank">IBM Cloud documentation</a>.</p>
</div></div></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="observability-logging.html" class="navigation navigation-prev " aria-label="Previous page: Logging">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="scaling.html" class="navigation navigation-next " aria-label="Next page: Scaling">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Monitoring","level":"7.3","depth":1,"next":{"title":"Scaling","level":"8.1","depth":1,"path":"scaling.md","ref":"scaling.md","articles":[]},"previous":{"title":"Logging","level":"7.2","depth":1,"path":"observability-logging.md","ref":"observability-logging.md","articles":[]},"dir":"ltr"},"config":{"plugins":["prism","-highlight","collapsible-chapters","hints","copy-code-button","back-to-top-button","fancybox","web-header","codetabs"],"root":"book","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"webheader":{"headerTitle":"Getting started with scalable web application on Kubernetes"},"prism":{"css":["prismjs/themes/prism-tomorrow.css"]},"fancybox":{"helpers":{"buttons":{}},"openEffect":"elastic","closeEffect":"elastic"},"web-header":{},"search":{},"collapsible-chapters":{},"codetabs":{},"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"back-to-top-button":{},"copy-code-button":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Getting started with scalable web application on Kubernetes","gitbook":"3.2.3"},"file":{"path":"observability-monitoring.md","mtime":"2018-11-11T11:11:11.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-11-11T11:11:11.000Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fancybox/jquery.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fancybox/jquery.mousewheel.pack.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fancybox/jquery.fancybox.pack.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fancybox/jquery.fancybox-buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fancybox/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-web-header/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-codetabs/codetabs.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

